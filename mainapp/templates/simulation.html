<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Grid Dashboard</title>
  <style>
    :root {
      --sidebar-width: 280px;
      --collapsed-width: 64px;
      --transition: 0.4s ease;
      --bg-color: #ffffff;
      --sidebar-bg: #f8f9fa;
      --grid-color: 224,224,224;
      --major-grid-color: 180,180,180;
      --axis-color: 150,150,150;
      --sidebar-mobile-width: 200px;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { overflow: hidden; font-family: sans-serif; background: var(--bg-color); }

    /* Sidebar styling */
    #sidebar {
      position: absolute;
      top: 0;
      left: 0;
      height: 100vh;
      width: var(--sidebar-width);
      background: var(--sidebar-bg);
      display: flex;
      flex-direction: column;
      padding: 16px;
      box-shadow: 2px 0 8px rgba(0,0,0,0.1);
      transition: width var(--transition), transform var(--transition);
      z-index: 10;
    }
    #sidebar.collapsed { width: var(--collapsed-width); }

    /* Toggle button styling */
    #toggle-btn {
      position: absolute;
      top: 16px;
      left: calc(var(--sidebar-width) + 16px);
      background: none;
      border: none;
      font-size: 1.6rem;
      cursor: pointer;
      z-index: 20;
      transition: left var(--transition);
    }
    #sidebar.collapsed + #toggle-btn {
      left: calc(var(--collapsed-width) + 16px);
    }

    /* Logo & Title */
    .logo {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      margin-bottom: 24px;
    }
    .logo img {
      width: 40px;
      height: auto;
      border-radius: 50%;
    }
    .logo h2 {
      font-size: 1.5em;
      font-weight: bold;
      color: #1f2937;
      margin: 12px 0 8px;
      white-space: nowrap;
      transition: opacity var(--transition), transform var(--transition);
    }
    #sidebar.collapsed .logo h2 {
      opacity: 0;
      transform: translateX(-20px);
    }

    /* YouTube Button styling */
    .yt-button {
      display: flex;
      align-items: center;
      padding: 0;
      background: transparent;
      border: none;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .yt-button img {
      width: 100%;
      max-width: 240px;
      border-radius: 4px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }
    .yt-button:hover {
      transform: scale(1.05);
    }
    #sidebar.collapsed .yt-button img {
      display: none;
    }

    /* Main full-screen canvas */
    #main {
      position: absolute;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
    }
    canvas {
      display: block;
      width: 100%;
      height: 100%; 
      animation: fadeIn 0.8s ease;
    }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    /* Mobile off-canvas */
    @media (max-width: 768px) {
      #sidebar {
        width: var(--sidebar-mobile-width);
        transform: translateX(-100%);
        padding-top: 56px;
      }
      #sidebar.open {
        transform: translateX(0);
      }
      #toggle-btn {
        top: 16px;
        left: 16px !important;
      }
    }
  </style>
</head>
<body>
  <div id="sidebar">
    <div class="logo">
      <a href="/">
        <img src="https://yt3.googleusercontent.com/so_LhC39A37h8HZqVIoIwu4NXuJ4AUBUY_C-K_2mmOInhadB-lsQHeAKursNZ4Zy1swMt-ibXQ=s72-c-k-c0x00ffffff-no-rj" alt="Pysics Logo">
      </a>
      <h2>Pysics Sim</h2>
      <button class="yt-button" id="yt-btn" title="Watch Video">
        <img src="https://img.youtube.com/vi/HHiUvE57I7k/0.jpg" alt="Video Thumbnail">
      </button>
    </div>
  </div>
  <button id="toggle-btn">â˜°</button>
  <div id="main"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.min.js"></script>
  <script>
    // Grid & panning variables
    let gridSize = 40, cols, rows;
    let offsetX = 0, offsetY = 0;
    let dragging = false, prevX, prevY;
    let showCircle = false;

    // Colors (will be initialized in setup)
    let gr, gg, gb, mr, mg, mb, ar, ag, ab;

    function setup() {
      // Create p5 canvas
      let canvas = createCanvas(windowWidth, windowHeight);
      canvas.parent('main');
      // Initialize grid
      updateGrid();
      // Read CSS variables for grid colors
      const css = getComputedStyle(document.documentElement);
      [gr, gg, gb] = css.getPropertyValue('--grid-color').split(',').map(n => +n);
      [mr, mg, mb] = css.getPropertyValue('--major-grid-color').split(',').map(n => +n);
      [ar, ag, ab] = css.getPropertyValue('--axis-color').split(',').map(n => +n);

      // UI event handlers
      select('#toggle-btn').mousePressed(toggleSidebar);
      select('#yt-btn').mousePressed(() => showCircle = true);
    }

    function draw() {
      background(255);
      drawGrid();
      if (showCircle) drawCenteredCircle();
    }

    // Draws a circle and a red dot at true canvas center
    function drawCenteredCircle() {
      push();
      resetMatrix();
      const diameter = min(width, height) * 0.5;
      noFill(); stroke(0); strokeWeight(2);
      ellipse(width/2, height/2, diameter, diameter);
      fill(255, 0, 0); noStroke();
      ellipse(width/2, height/2, 12, 12);
      pop();
    }

    function drawGrid() {
      push();
      translate(width/2 + offsetX, height/2 + offsetY);
      const maxD = max(width, height) * 2;
      const pulse = 100 + 50 * sin(frameCount * 0.02);
      for (let i = -cols; i <= cols; i++) drawLine(i, true, pulse, maxD);
      for (let j = -rows; j <= rows; j++) drawLine(j, false, pulse, maxD);
      pop();
    }

    function drawLine(i, vertical, pulse, maxD) {
      if (i === 0) stroke(ar, ag, ab, 255), strokeWeight(2);
      else if (i % 5 === 0) stroke(mr, mg, mb, pulse), strokeWeight(1);
      else stroke(gr, gg, gb, pulse * 0.8), strokeWeight(0.5);
      vertical
        ? line(i * gridSize, -maxD, i * gridSize, maxD)
        : line(-maxD, i * gridSize, maxD, i * gridSize);
    }

    function toggleSidebar() {
      const sb = select('#sidebar');
      const isMobile = window.matchMedia('(max-width:768px)').matches;
      if (isMobile) sb.toggleClass('open');
      else sb.toggleClass('collapsed');
    }

    function updateGrid() {
      cols = ceil((width / 2) / gridSize);
      rows = ceil((height / 2) / gridSize);
    }

    function windowResized() {
      resizeCanvas(windowWidth, windowHeight);
      updateGrid();
    }

    function mousePressed() {
      dragging = true;
      prevX = mouseX;
      prevY = mouseY;
    }
    function mouseDragged() {
      if (dragging) {
        offsetX += mouseX - prevX;
        offsetY += mouseY - prevY;
        prevX = mouseX;
        prevY = mouseY;
      }
    }
    function mouseReleased() {
      dragging = false;
    }
    function mouseWheel(event) {
      gridSize = constrain(gridSize * (event.delta > 0 ? 0.9 : 1.1), 10, 200);
      updateGrid();
      return false;
    }
  </script>
</body>
</html>
